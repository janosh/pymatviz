default_install_hook_types: [pre-commit, commit-msg]

repos:
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.15.2
    hooks:
      - id: ruff-check
        args: [--fix]
        types_or: [python, jupyter]
      - id: ruff-format
        types_or: [python, jupyter]

  - repo: local
    hooks:
      - id: ty
        name: ty check
        entry: ty check --ignore unused-type-ignore-comment --ignore unused-ignore-comment
        language: python
        types: [python]
        pass_filenames: false
        additional_dependencies: [ty==0.0.18]
      - id: check-readme-src-links
        name: Check README source links
        entry: python .github/scripts/check_readme_src_links.py
        language: python
        files: ^(readme\.md|pymatviz/.*\.py)$
        pass_filenames: false

  - repo: local
    hooks:
      - id: marimo-check
        name: marimo check
        entry: marimo check --strict
        language: python
        files: examples/widgets/marimo_demo\.py$
        additional_dependencies: [marimo]

  - repo: https://github.com/janosh/format-ipy-cells
    rev: v0.1.11
    hooks:
      - id: format-ipy-cells

  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      - id: check-case-conflict
      - id: check-symlinks
      - id: check-yaml
      - id: destroyed-symlinks
      - id: end-of-file-fixer
        exclude: ^assets/.+\.(svg|html)$
      - id: mixed-line-ending
      - id: trailing-whitespace
      - id: check-added-large-files
        args: [--maxkb=1024]

  - repo: https://github.com/codespell-project/codespell
    rev: v2.4.1
    hooks:
      - id: codespell
        stages: [pre-commit, commit-msg]
        exclude_types: [csv, svg, html, yaml, jupyter]
        args: [--ignore-words-list, 'hist,mape,te,nd,fpr,abou,nam', --check-filenames]

  - repo: https://github.com/kynan/nbstripout
    rev: 0.9.1
    hooks:
      - id: nbstripout
        args: [--drop-empty-cells, --keep-output]

  - repo: local
    hooks:
      - id: deno-fmt # pinned to 2.3.7 due to https://github.com/denoland/deno/issues/29968
        name: Deno format
        entry: deno fmt
        types_or: [file]
        language: system
        args: [--config, pymatviz/widgets/web/deno.jsonc, --permit-no-files]
        exclude_types: [jupyter, json]
        exclude: ^readme.md$ # deno fmt doesn't support ![fig-icon] syntax
      - id: deno-lint # pinned to 2.3.7 due to https://github.com/pngwn/MDsveX/issues/743
        name: Deno lint
        entry: deno lint
        types_or: [file]
        language: system
        args:
          - --config
          - pymatviz/widgets/web/deno.jsonc
          - --permit-no-files
          - --fix

  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v10.0.1
    hooks:
      - id: eslint
        types: [file]
        args: [--fix, --config, site/eslint.config.js]
        files: \.(js|ts|svelte)$
        additional_dependencies:
          - eslint
          - eslint-plugin-svelte
          - svelte
          - typescript
          - typescript-eslint
          - '@stylistic/eslint-plugin'

  - repo: https://github.com/python-jsonschema/check-jsonschema
    rev: 0.36.2
    hooks:
      - id: check-jsonschema
        files: ^pymatviz/keys\.yml$
        args: [--schemafile, tests/keys-schema.yml]
